# å®‰è£…Kuboard
> å‚è€ƒæ–‡æ¡£ï¼šhttps://kuboard.cn/install/install-dashboard.html#%E5%AE%89%E8%A3%85

> - æ— éœ€ç¼–å†™YAML
> - çº¯å›¾å½¢åŒ–ç¯å¢ƒ
> - å¤šç¯å¢ƒç®¡ç†

### 1. å‰æ
> å®‰è£… Kuboard æ—¶ï¼Œå‡è®¾æ‚¨å·²ç»æœ‰ä¸€ä¸ª Kubernetes é›†ç¾¤

#### å…¼å®¹æ€§
| Kubernetes ç‰ˆæœ¬ | Kuboard ç‰ˆæœ¬ | å…¼å®¹æ€§ | è¯´æ˜                                                                                    |
| --------------- | ------------ | ------ | --------------------------------------------------------------------------------------- |
| v1.16           | v1.0         | ğŸ˜„     | å·²éªŒè¯                                                                                  |
| v1.15           | v1.0         | ğŸ˜„     | å·²éªŒè¯                                                                                  |
| v1.14           | v1.0         | ğŸ˜„     | å·²éªŒè¯                                                                                  |
| v1.13           | v1.0         | ğŸ˜„     | å·²éªŒè¯                                                                                  |
| v1.12           | v1.0         | ğŸ˜     | Kubernetes Api v1.12 å°šä¸æ”¯æŒ dryRunï¼Œå¿½ç•¥Kuboardåœ¨æ‰§è¡Œå‘½ä»¤æ—¶çš„å‚æ•°æ ¡éªŒé”™è¯¯ï¼Œå¯æ­£å¸¸å·¥ä½œ |
| v1.11           | v1.0         | ğŸ˜     | åŒä¸Š                                                                                    |

### 2. å®‰è£…
å®‰è£… Kuboardã€‚
> å¦‚æœæ‚¨å‚è€ƒ https://kuboard.cn ç½‘ç«™ä¸Šæä¾›çš„ Kubernetes å®‰è£…æ–‡æ¡£ï¼Œå¯åœ¨ master èŠ‚ç‚¹ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚

```sh
kubectl apply -f https://kuboard.cn/install-script/kuboard.yaml
```
æŸ¥çœ‹ Kuboard è¿è¡ŒçŠ¶æ€ï¼š
```sh
kubectl get pods -l k8s.eip.work/name=kuboard -n kube-system
```
è¾“å‡ºç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š
```sh
NAME                       READY   STATUS        RESTARTS   AGE
kuboard-54c9c4f6cb-6lf88   1/1     Running       0          45s
```
å¦‚æœæ‚¨ä¸€ç›´ä¸èƒ½çœ‹åˆ° kuboard å¤„äº Running çŠ¶æ€ï¼Œå¯å‚è€ƒ è¯Šæ–­åº”ç”¨ç¨‹åºï¼ŒæŸ¥æ‰¾åŸå› ã€‚

### 3. å¸è½½ Kuboard
```sh
kubectl delete -f https://kuboard.cn/install-script/kuboard.yaml
```
### 4. è·å–Token
æ‚¨å¯ä»¥è·å¾—ç®¡ç†å‘˜ç”¨æˆ·ã€åªè¯»ç”¨æˆ·çš„Token
#### a. ç®¡ç†å‘˜
##### æ‹¥æœ‰çš„æƒé™
- æ­¤Tokenæ‹¥æœ‰ ClusterAdmin çš„æƒé™ï¼Œå¯ä»¥æ‰§è¡Œæ‰€æœ‰æ“ä½œ

##### æ‰§è¡Œå‘½ä»¤
```sh
# å¦‚æœæ‚¨å‚è€ƒ www.kuboard.cn æä¾›çš„æ–‡æ¡£å®‰è£… Kuberenetesï¼Œå¯åœ¨ç¬¬ä¸€ä¸ª Master èŠ‚ç‚¹ä¸Šæ‰§è¡Œæ­¤å‘½ä»¤
kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep kuboard-user | awk '{print $1}')
```
##### è¾“å‡º
å–è¾“å‡ºä¿¡æ¯ä¸­ token å­—æ®µ
```sh
Name: admin-user-token-g8hxb
Namespace: kube-system
Labels: <none>
Annotations: [kubernetes.io/service-account.name](http://kubernetes.io/service-account.name): Kuboard-user
[kubernetes.io/service-account.uid](http://kubernetes.io/service-account.uid): 948bb5e6-8cdc-11e9-b67e-fa163e5f7a0f

Type: [kubernetes.io/service-account-token](http://kubernetes.io/service-account-token)

Data
====
ca.crt: 1025 bytes
namespace: 11 bytes
token: eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLWc4aHhiIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiI5NDhiYjVlNi04Y2RjLTExZTktYjY3ZS1mYTE2M2U1ZjdhMGYiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06YWRtaW4tdXNlciJ9.DZ6dMTr8GExo5IH_vCWdB_MDfQaNognjfZKl0E5VW8vUFMVvALwo0BS-6Qsqpfxrlz87oE9yGVCpBYV0D00811bLhHIg-IR_MiBneadcqdQ_TGm_a0Pz0RbIzqJlRPiyMSxk1eXhmayfPn01upPdVCQj6D3vAY77dpcGplu3p5wE6vsNWAvrQ2d_V1KhR03IB1jJZkYwrI8FHCq_5YuzkPfHsgZ9MBQgH-jqqNXs6r8aoUZIbLsYcMHkin2vzRsMy_tjMCI9yXGiOqI-E5efTb-_KbDVwV5cbdqEIegdtYZ2J3mlrFQlmPGYTwFI8Ba9LleSYbCi4o0k74568KcN_w
```
#### b. åªè¯»ç”¨æˆ·
##### æ‹¥æœ‰çš„æƒé™
- view å¯æŸ¥çœ‹åç§°ç©ºé—´çš„å†…å®¹
- system:node å¯æŸ¥çœ‹èŠ‚ç‚¹ä¿¡æ¯
- system:persistent-volume-provisioner å¯æŸ¥çœ‹å­˜å‚¨ç±»å’Œå­˜å‚¨å·å£°æ˜çš„ä¿¡æ¯

##### é€‚ç”¨åœºæ™¯
åªè¯»ç”¨æˆ·ä¸èƒ½å¯¹é›†ç¾¤çš„é…ç½®æ‰§è¡Œä¿®æ”¹æ“ä½œï¼Œéå¸¸é€‚ç”¨äºå°†å¼€å‘ç¯å¢ƒä¸­çš„ Kuboard åªè¯»æƒé™åˆ†å‘ç»™å¼€å‘è€…ï¼Œä»¥ä¾¿å¼€å‘è€…å¯ä»¥ä¾¿æ·åœ°è¯Šæ–­é—®é¢˜
##### æ‰§è¡Œå‘½ä»¤
æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å¯ä»¥è·å¾— **åªè¯»ç”¨æˆ· çš„ Token**
```sh
# å¦‚æœæ‚¨å‚è€ƒ www.kuboard.cn æä¾›çš„æ–‡æ¡£å®‰è£… Kuberenetesï¼Œå¯åœ¨ç¬¬ä¸€ä¸ª Master èŠ‚ç‚¹ä¸Šæ‰§è¡Œæ­¤å‘½ä»¤
kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep kuboard-viewer | awk '{print $1}')
```
##### è¾“å‡º
å–è¾“å‡ºä¿¡æ¯ä¸­ token å­—æ®µ
```sh
Name: admin-user-token-g8hxb
Namespace: kube-system
Labels: <none>
Annotations: [kubernetes.io/service-account.name](http://kubernetes.io/service-account.name): Kuboard-viewer
[kubernetes.io/service-account.uid](http://kubernetes.io/service-account.uid): 948bb5e6-8cdc-11e9-b67e-fa163e5f7a0f

Type: [kubernetes.io/service-account-token](http://kubernetes.io/service-account-token)

Data
====
ca.crt: 1025 bytes
namespace: 11 bytes
token: eyJhbGciOiJSUzI1NiIsImtpZCI6IiJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJhZG1pbi11c2VyLXRva2VuLWc4aHhiIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6ImFkbWluLXVzZXIiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC51aWQiOiI5NDhiYjVlNi04Y2RjLTExZTktYjY3ZS1mYTE2M2U1ZjdhMGYiLCJzdWIiOiJzeXN0ZW06c2VydmljZWFjY291bnQ6a3ViZS1zeXN0ZW06YWRtaW4tdXNlciJ9.DZ6dMTr8GExo5IH_vCWdB_MDfQaNognjfZKl0E5VW8vUFMVvALwo0BS-6Qsqpfxrlz87oE9yGVCpBYV0D00811bLhHIg-IR_MiBneadcqdQ_TGm_a0Pz0RbIzqJlRPiyMSxk1eXhmayfPn01upPdVCQj6D3vAY77dpcGplu3p5wE6vsNWAvrQ2d_V1KhR03IB1jJZkYwrI8FHCq_5YuzkPfHsgZ9MBQgH-jqqNXs6r8aoUZIbLsYcMHkin2vzRsMy_tjMCI9yXGiOqI-E5efTb-_KbDVwV5cbdqEIegdtYZ2J3mlrFQlmPGYTwFI8Ba9LleSYbCi4o0k74568KcN_w
```
### 3. è®¿é—®Kuboard
æ‚¨å¯ä»¥é€šè¿‡NodePortã€port-forward ä¸¤ç§æ–¹å¼å½“ä¸­çš„ä»»æ„ä¸€ç§è®¿é—® Kuboard
####  NodePort çš„æ–¹å¼
Kuboard Service ä½¿ç”¨äº† NodePort çš„æ–¹å¼æš´éœ²æœåŠ¡ï¼ŒNodePort ä¸º 32567ï¼›æ‚¨å¯ä»¥æŒ‰å¦‚ä¸‹æ–¹å¼è®¿é—® Kuboardã€‚
```
http://ä»»æ„ä¸€ä¸ªWorkerèŠ‚ç‚¹çš„IPåœ°å€:32567/
```
è¾“å…¥å‰ä¸€æ­¥éª¤ä¸­è·å¾—çš„ tokenï¼Œå¯è¿›å…¥** Kuboard é›†ç¾¤æ¦‚è§ˆé¡µ**
> TIP
> - å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰ï¼Œè¯·åœ¨å…¶å®‰å…¨ç»„è®¾ç½®é‡Œå¼€æ”¾ worker èŠ‚ç‚¹ 32567 ç«¯å£çš„å…¥ç«™è®¿é—®ï¼Œ
> - æ‚¨ä¹Ÿå¯ä»¥ä¿®æ”¹ Kuboard.yaml æ–‡ä»¶ï¼Œä½¿ç”¨è‡ªå·±å®šä¹‰çš„ NodePort ç«¯å£å·

#### port-forward æ–¹å¼
åœ¨æ‚¨çš„å®¢æˆ·ç«¯ç”µè„‘ä¸­æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤
```sh
kubectl port-forward service/kuboard 8080:80 -n kube-system
```
åœ¨æµè§ˆå™¨æ‰“å¼€é“¾æ¥ ï¼ˆè¯·ä½¿ç”¨ kubectl æ‰€åœ¨æœºå™¨çš„IPåœ°å€ï¼‰
```
http://localhost:8080
```
è¾“å…¥å‰ä¸€æ­¥éª¤ä¸­è·å¾—çš„ tokenï¼Œå¯è¿›å…¥ Kuboard é›†ç¾¤æ¦‚è§ˆé¡µ

> #### TIP
> éœ€è¦æ‚¨å…ˆå®Œæˆ **ä»å®¢æˆ·ç«¯ç”µè„‘è¿œç¨‹ç®¡ç† Kubernetes çš„é…ç½®**

### 4. å…ç™»é™†è®¿é—®
å¯ä»¥é€šè¿‡æŸ¥è¯¢å‚æ•°ä¸­çš„ k8sToken å­—æ®µç›´æ¥ç™»å½•ç³»ç»Ÿï¼Œæ— éœ€åœ¨ç™»å½•ç•Œé¢è¾“å…¥ Tokenã€‚

#### ç›´æ¥è®¿é—®é›†ç¾¤æ¦‚è§ˆé¡µ
å¦‚éœ€è¦æ— ç™»å½•è®¿é—®é›†ç¾¤æ¦‚è§ˆé¡µé¢ï¼Œå¯ä½¿ç”¨å¦‚ä¸‹æ ¼å¼çš„ url è¿›å…¥ï¼š
```
http://ä»»æ„ä¸€ä¸ªWorkerèŠ‚ç‚¹çš„IPåœ°å€:32567/#/dashboard?k8sToken=yourToken
```
> #### å…¶ä»–ç•Œé¢
å…¶ä»–ä»»æ„ Kuboard ç•Œé¢åŒç†ï¼Œåªéœ€è¦å¢åŠ  k8sToken ä½œä¸ºæŸ¥è¯¢å‚æ•°ï¼Œå³å¯è·³è¿‡è¾“å…¥ Token çš„æ­¥éª¤

#### ç›´æ¥è®¿é—®ç»ˆç«¯ç•Œé¢
å¦‚æœæƒ³è¦æ— ç™»å½•ç›´æ¥è®¿é—®å®¹å™¨ç»„çš„æ§åˆ¶å°ï¼Œå¯ä½¿ç”¨å¦‚ä¸‹æ ¼å¼çš„ url è¿›å…¥ï¼š
```
http://ä»»æ„ä¸€ä¸ªWorkerèŠ‚ç‚¹çš„IPåœ°å€:32567/#/console/pzy/yourPod?containerName=yourContainer&shell=bash&k8sToken=yourToken
```
å…¶ä¸­ï¼Œshell å‚æ•°å¯é€‰å–å€¼æœ‰ï¼š
- bashï¼Œä½¿ç”¨ /bin/bash ä½œä¸º shell
- shï¼Œ ä½¿ç”¨ /bin/sh ä½œä¸º shell
